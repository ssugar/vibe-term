# Milestone v1.3: Hook Management & Distribution

**Status:** SHIPPED 2026-02-02
**Phases:** 12-17
**Total Plans:** 11

## Overview

Make vibe-term easy to install and self-managing for Claude hooks. Users can install globally via npm, set up hooks automatically, audit for conflicts, and fix them intelligently.

## Phases

### Phase 12: Foundation Services

**Goal**: Core services for file operations that all CLI commands depend on
**Depends on**: Phase 11 (v2.0 complete)
**Requirements**: SETUP-02, CLI-01, CLI-02
**Plans**: 2 plans in 1 wave

Plans:
- [x] 12-01-PLAN.md — CLI output utilities and vibe-term directory service
- [x] 12-02-PLAN.md — Settings service for Claude settings.json management

**Success Criteria:**
1. vibeTermDirService can create ~/.vibe-term/ directory and install hook scripts
2. settingsService can read/write/backup Claude settings.json files with error handling
3. CLI output utilities support colored text (green/yellow/red) and status symbols
4. Backup files use human-readable timestamps (settings.json.vibe-term-backup.TIMESTAMP)

### Phase 13: CLI Router & Setup Command

**Goal**: Users can run `vibe-term setup` to install global hooks with automatic backup
**Depends on**: Phase 12
**Requirements**: SETUP-01, SETUP-03, SETUP-04, SETUP-05, SETUP-06, SETUP-07
**Plans**: 2 plans in 2 waves

Plans:
- [x] 13-01-PLAN.md — Hook merger service for installation detection and merging
- [x] 13-02-PLAN.md — CLI router and setup command implementation

**Success Criteria:**
1. User can run `vibe-term setup` to install hooks to ~/.claude/settings.json
2. Running setup creates backup of existing settings before modification
3. Running setup multiple times is safe (idempotent, no duplicate hooks)
4. Setup displays colored success/failure output showing what files changed
5. Setup supports `--yes` flag for non-interactive mode

### Phase 14: Audit Command

**Goal**: Users can discover all Claude projects and scan for hook conflicts
**Depends on**: Phase 13
**Requirements**: AUDIT-01 through AUDIT-08
**Plans**: 2 plans in 2 waves

Plans:
- [x] 14-01-PLAN.md — Project scanner and conflict detector services
- [x] 14-02-PLAN.md — Audit CLI command and router integration

**Success Criteria:**
1. User can run `vibe-term audit` to scan ~/.claude/projects/ for conflicts
2. Audit shows pass/warn/fail status per project with colored output
3. Audit lists specific conflicts found per project
4. Audit returns exit code 0 when clean, 1 when conflicts found
5. Audit can filter to only show projects with conflicts

### Phase 15: Fix Command

**Goal**: Users can fix hook conflicts with intelligent merging that preserves existing hooks
**Depends on**: Phase 14
**Requirements**: FIX-01 through FIX-06
**Plans**: 2 plans in 2 waves

Plans:
- [x] 15-01-PLAN.md — Project fixer service for preview generation and fix application
- [x] 15-02-PLAN.md — Fix CLI command and router integration

**Success Criteria:**
1. User can run `vibe-term fix` to preview what would change (dry-run default)
2. User can run `vibe-term fix --apply` to execute changes
3. Fix creates backup before modifying any project settings
4. Fix merges hooks intelligently (adds vibe-term alongside existing, no clobbering)
5. User can fix a single project with `vibe-term fix /path/to/project`

### Phase 16: CLI Polish

**Goal**: CLI commands support machine-readable output and guide users to next steps
**Depends on**: Phase 15
**Requirements**: CLI-03, CLI-04
**Plans**: 2 plans in 2 waves

Plans:
- [x] 16-01-PLAN.md — JSON infrastructure (types, formatters, dual-mode output)
- [x] 16-02-PLAN.md — Apply JSON mode and suggestions to all commands

**Success Criteria:**
1. All commands support `--json` flag for machine-readable output
2. Setup suggests running audit after completion
3. Audit with issues suggests running fix
4. Fix suggests verifying with audit after applying

### Phase 17: Distribution & Documentation

**Goal**: Users can install vibe-term globally via npm and have clear documentation
**Depends on**: Phase 16
**Requirements**: DIST-01 through DIST-04, DOCS-01 through DOCS-03
**Plans**: 1 plan in 1 wave

Plans:
- [x] 17-01-PLAN.md — npm package configuration and README rewrite

**Success Criteria:**
1. User can install with `npm install -g vibe-term` without sudo
2. `vibe-term` command works after global install
3. Package includes only necessary files (minimal install size)
4. README documents installation steps, setup/audit/fix commands, and hook workflow

---

## Milestone Summary

**Key Decisions:**
- ~/.vibe-term/ for hooks script and config (persistent, portable)
- Intelligent hook merging (preserve project hooks while adding vibe-term's)
- CLI subcommands before TUI initialization (command-or-TUI router pattern)
- picocolors for CLI colored output (lightweight, no dependencies)
- figures for cross-platform status symbols
- Preview/Apply pattern: generateFixPreview shows what will change, applyFix executes
- Dry-run by default for fix command, --apply required to execute changes
- JSON mode requires --yes for confirmation-needed operations (non-interactive)

**Issues Resolved:**
- Hook conflict detection for projects with existing hook configurations
- Safe merging without clobbering user's custom hooks
- Minimal npm package size (28.4 kB vs 385 kB)

**Technical Debt Incurred:**
- None significant

---

*For current project status, see .planning/ROADMAP.md*
