---
phase: 12-foundation-services
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli/output.ts
  - src/services/vibeTermDirService.ts
autonomous: true

must_haves:
  truths:
    - "CLI commands can display green text with checkmark symbol"
    - "CLI commands can display red text with X symbol"
    - "CLI commands can display yellow text with warning symbol"
    - "~/.vibe-term/ directory can be created idempotently"
    - "Hook script can be written to ~/.vibe-term/ with executable permissions"
  artifacts:
    - path: "src/cli/output.ts"
      provides: "CLI color and symbol utilities"
      exports: ["success", "error", "warning", "info", "green", "red", "yellow", "cyan", "dim", "bold", "filePath"]
    - path: "src/services/vibeTermDirService.ts"
      provides: "~/.vibe-term/ directory management"
      exports: ["ensureVibeTermDir", "getVibeTermDir", "getVibeTermPath", "writeVibeTermFile", "readVibeTermFile", "vibeTermFileExists", "installHookScript"]
  key_links:
    - from: "src/cli/output.ts"
      to: "picocolors"
      via: "import"
      pattern: "import pc from 'picocolors'"
    - from: "src/cli/output.ts"
      to: "figures"
      via: "import"
      pattern: "import figures from 'figures'"
---

<objective>
Create CLI output utilities and vibe-term directory service for v3.0 CLI commands.

Purpose: All v3.0 CLI commands (setup, audit, fix) need colored output with status symbols and a persistent ~/.vibe-term/ directory for hook scripts. These foundation services enable consistent UX across all commands.

Output:
- src/cli/output.ts - Colored output helpers with status symbols
- src/services/vibeTermDirService.ts - ~/.vibe-term/ directory management with hook script installation
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-foundation-services/12-RESEARCH.md
@src/hooks/status-hook.sh (existing hook script to embed)
@package.json (need to add picocolors)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install picocolors and create CLI output utilities</name>
  <files>package.json, src/cli/output.ts</files>
  <action>
1. Install picocolors:
   ```bash
   npm install picocolors
   ```

2. Create src/cli/ directory if it doesn't exist

3. Create src/cli/output.ts with the following:
   - Import `pc` from `picocolors` and `figures` from `figures`
   - Export status message functions that combine colors and symbols:
     - `success(msg)` - green checkmark + message
     - `error(msg)` - red X + message
     - `warning(msg)` - yellow warning symbol + message
     - `info(msg)` - blue info symbol + message
   - Export color helper functions (return strings for composition):
     - `green`, `red`, `yellow`, `cyan`, `dim`, `bold`
   - Export semantic helpers:
     - `filePath(p)` - cyan for file paths
     - `timestamp(t)` - dim for timestamps
     - `keyValue(key, value)` - formatted key: value output
     - `heading(text)` - bold heading

Pattern from research:
```typescript
import pc from 'picocolors';
import figures from 'figures';

export function success(message: string): void {
  console.log(`${pc.green(figures.tick)} ${message}`);
}
```

IMPORTANT: Use `.js` extension in any imports within the file for ESM compatibility.
  </action>
  <verify>
1. `npm ls picocolors` shows picocolors installed
2. File exists at src/cli/output.ts
3. TypeScript compiles: `npm run typecheck`
  </verify>
  <done>
- picocolors added to dependencies in package.json
- src/cli/output.ts exports success, error, warning, info, green, red, yellow, cyan, dim, bold, filePath, timestamp, keyValue, heading
- TypeScript compilation passes
  </done>
</task>

<task type="auto">
  <name>Task 2: Create vibeTermDirService with hook script installation</name>
  <files>src/services/vibeTermDirService.ts</files>
  <action>
1. Create src/services/vibeTermDirService.ts with the following exports:

   - `VIBE_TERM_DIR` constant: `path.join(os.homedir(), '.vibe-term')`

   - `ensureVibeTermDir()`: Create ~/.vibe-term/ directory with `mkdir({ recursive: true })`

   - `getVibeTermDir()`: Return the VIBE_TERM_DIR path

   - `getVibeTermPath(filename)`: Return full path to file in ~/.vibe-term/

   - `writeVibeTermFile(filename, content, options?)`:
     - Call ensureVibeTermDir() first
     - Write file with utf-8 encoding
     - If options.executable is true, chmod 755
     - Return the full path

   - `readVibeTermFile(filename)`:
     - Return file content or null if not found
     - Throw on other errors

   - `vibeTermFileExists(filename)`:
     - Return true/false using access() check

   - `installHookScript()`:
     - Embed the contents of src/hooks/status-hook.sh as a template string
     - Write to ~/.vibe-term/status-hook.sh with executable: true
     - Return the path where script was installed

2. Use these imports:
   ```typescript
   import { mkdir, writeFile, readFile, access, constants, chmod } from 'fs/promises';
   import { join } from 'path';
   import { homedir } from 'os';
   ```

3. Hook script embedding: Copy the EXACT contents of src/hooks/status-hook.sh as a multi-line template literal. Do NOT modify the script content.

IMPORTANT: Use `.js` extension in any imports for ESM compatibility.
  </action>
  <verify>
1. File exists at src/services/vibeTermDirService.ts
2. TypeScript compiles: `npm run typecheck`
3. Manual test (optional): Run in node REPL
   ```javascript
   import { ensureVibeTermDir, getVibeTermDir } from './dist/services/vibeTermDirService.js';
   await ensureVibeTermDir();
   console.log(getVibeTermDir()); // Should print ~/.vibe-term path
   ```
  </verify>
  <done>
- src/services/vibeTermDirService.ts exists with all exports
- Hook script content embedded as template string
- installHookScript() writes executable script to ~/.vibe-term/
- TypeScript compilation passes
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. TypeScript compilation passes:
   ```bash
   npm run typecheck
   ```

2. Package dependencies include picocolors:
   ```bash
   npm ls picocolors
   ```

3. Files exist:
   - src/cli/output.ts
   - src/services/vibeTermDirService.ts

4. Build succeeds:
   ```bash
   npm run build
   ```
</verification>

<success_criteria>
- picocolors installed as dependency
- CLI output module provides colored status functions (success, error, warning)
- CLI output module provides color helpers (green, red, yellow)
- vibeTermDirService can create ~/.vibe-term/ idempotently
- vibeTermDirService can install hook script with executable permissions
- TypeScript compilation passes
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/12-foundation-services/12-01-SUMMARY.md`
</output>
