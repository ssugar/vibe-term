---
phase: 17-distribution-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - README.md
autonomous: true

must_haves:
  truths:
    - "npm pack --dry-run shows only dist/ files (plus package.json, README, LICENSE)"
    - "Package size is under 100KB (down from 385KB)"
    - "README opens with what vibe-term does, then installation"
    - "README documents setup, audit, and fix commands"
    - "README explains hook workflow (setup -> audit -> fix)"
    - "README includes platform-specific troubleshooting"
  artifacts:
    - path: "package.json"
      provides: "npm distribution configuration"
      contains: '"files": ["dist"]'
    - path: "package.json"
      provides: "build verification"
      contains: '"prepublishOnly"'
    - path: "README.md"
      provides: "User documentation"
      min_lines: 150
  key_links:
    - from: "package.json"
      to: "dist/cli.js"
      via: "bin field"
      pattern: '"vibe-term": "dist/cli.js"'
    - from: "README.md"
      to: "vibe-term setup"
      via: "command documentation"
      pattern: "vibe-term setup"
---

<objective>
Configure npm package for minimal global installation and rewrite README with clear documentation for installation, commands, and hook workflow.

Purpose: Enable users to install vibe-term globally via npm and understand how to use it
Output: Updated package.json with files field and prepublishOnly script; rewritten README.md
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-distribution-documentation/17-CONTEXT.md
@.planning/phases/17-distribution-documentation/17-RESEARCH.md
@package.json
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure package.json for npm distribution</name>
  <files>package.json</files>
  <action>
Update package.json with the following changes:

1. Add `files` field to whitelist only dist directory:
   ```json
   "files": ["dist"]
   ```
   This reduces package from 385KB/202 files to ~100KB with only dist/*.js files.
   Note: package.json, README.md, and LICENSE are always included automatically.

2. Add `prepublishOnly` script to ensure fresh build before publish:
   ```json
   "prepublishOnly": "npm run build"
   ```
   This prevents publishing stale dist/ contents.

3. Update description to be TUI-focused (per CONTEXT.md):
   ```json
   "description": "Terminal HUD for managing Claude Code sessions"
   ```

4. Optionally add/update keywords to improve discoverability:
   - Keep existing: terminal, tui, hud, tmux
   - Add: claude, claude-code, sessions
   - Remove generic: ai, coding, multiplexer

Do NOT change: name, version, bin, main, type, engines, repository, dependencies, devDependencies

After changes, verify with:
```bash
npm run build && npm pack --dry-run
```

Expected output should show ONLY:
- package.json
- README.md
- dist/*.js files (cli.js, chunk-*.js, audit-*.js, setup-*.js, fix-*.js)
- dist/cli.d.ts
  </action>
  <verify>
Run `npm pack --dry-run 2>&1 | grep -E "^npm notice (package size|total files|dist/)"` and confirm:
- package size < 100kB
- total files < 15
- Only dist/ files listed (no src/, no .planning/, no scripts/)
  </verify>
  <done>
Package.json has files field restricting to dist only, prepublishOnly script added, npm pack shows minimal package under 100KB
  </done>
</task>

<task type="auto">
  <name>Task 2: Rewrite README with decided structure</name>
  <files>README.md</files>
  <action>
Rewrite README.md following the structure from CONTEXT.md and RESEARCH.md:

**Structure:**

1. **Title + one-line description**
   ```markdown
   # vibe-term

   Terminal HUD for managing Claude Code sessions.
   ```

2. **Screenshot placeholder**
   ```markdown
   ![vibe-term TUI](./docs/screenshot.png)
   ```
   Note: Screenshot to be added later; placeholder is fine for now.

3. **What it does** (brief - 3-4 sentences max)
   - Describe the HUD strip showing session tabs
   - Mention status indicators (working/idle/blocked) and context usage
   - Note one-keypress session switching

4. **Installation**
   ```markdown
   ## Installation

   ```bash
   npm install -g vibe-term
   ```
   ```

5. **Prerequisites**
   - Node.js 20+
   - tmux
   - Claude Code CLI

6. **Quick start**
   Basic usage: `vibe-term` to launch TUI

7. **Hook Setup Commands** (the main v3.0 feature)
   Document the three commands with one-liner descriptions and flags:

   **setup**: Install global hooks
   ```bash
   vibe-term setup          # Install hooks to ~/.claude/settings.json
   vibe-term setup --yes    # Skip confirmation
   vibe-term setup --json   # JSON output for scripting
   ```

   **audit**: Scan for conflicts
   ```bash
   vibe-term audit              # Scan all projects
   vibe-term audit --conflicts  # Show only conflicts
   vibe-term audit --json       # JSON output
   ```

   **fix**: Resolve conflicts
   ```bash
   vibe-term fix            # Preview changes (dry-run)
   vibe-term fix --apply    # Apply fixes with backup
   vibe-term fix /path      # Fix single project
   vibe-term fix --json     # JSON output (requires --yes)
   ```

8. **Hook Workflow Explanation**
   Brief explanation (assume users know what Claude hooks are):
   - vibe-term tracks session status via hooks (working/idle/blocked)
   - setup installs global hooks
   - Project-level settings can override global hooks
   - audit detects projects with conflicting hooks
   - fix merges vibe-term hooks with existing project hooks

9. **TUI Keybindings** (reference table)
   Keep existing keybindings table from current README

10. **Troubleshooting**
    - tmux not found: Platform-specific install commands (brew, apt)
    - Permission errors on npm install -g: Document nvm or npm prefix config
    - WSL2 notes: Restart WSL if tmux behaves oddly

11. **License**
    ISC

**Tone:** Technical, concise, assume CLI proficiency. No marketing language.

**What to remove from current README:**
- "The Problem" section (redundant with What it does)
- Detailed hooks JSON configuration (replaced by setup command)
- scripts/add-hud-hooks.sh reference (replaced by fix command)
- Configuration section (defer to later - not essential for v1)
- "How It Works" section (too detailed for README)
  </action>
  <verify>
1. Check README has all required sections:
   ```bash
   grep -E "^## (Installation|Prerequisites|Hook Setup|Troubleshooting)" README.md
   ```

2. Check commands are documented:
   ```bash
   grep -E "vibe-term (setup|audit|fix)" README.md | wc -l
   ```
   Should be >= 9 (3 commands x 3 variants each)

3. Check troubleshooting has platform notes:
   ```bash
   grep -E "(brew install|apt install|npm config)" README.md
   ```
  </verify>
  <done>
README documents: installation via npm install -g, prerequisites, setup/audit/fix commands with flags, hook workflow explanation, platform-specific troubleshooting
  </done>
</task>

</tasks>

<verification>
1. Package size verification:
   ```bash
   npm run build && npm pack --dry-run 2>&1 | grep "package size"
   ```
   Must show < 100kB

2. Files included verification:
   ```bash
   npm pack --dry-run 2>&1 | grep -c "npm notice.*dist/"
   ```
   Should be ~10-15 files (only dist/)

3. No source files:
   ```bash
   npm pack --dry-run 2>&1 | grep -c "npm notice.*src/"
   ```
   Should be 0

4. README completeness:
   ```bash
   wc -l README.md
   ```
   Should be 150+ lines

5. Global install simulation (optional):
   ```bash
   npm pack && npm install -g ./vibe-term-1.0.0.tgz
   vibe-term --help
   ```
</verification>

<success_criteria>
- [ ] package.json has `"files": ["dist"]`
- [ ] package.json has `"prepublishOnly": "npm run build"`
- [ ] npm pack shows package size < 100KB
- [ ] npm pack shows < 15 total files
- [ ] npm pack shows NO src/ or .planning/ files
- [ ] README has Installation section with `npm install -g vibe-term`
- [ ] README has Prerequisites section (Node.js 20+, tmux, Claude Code)
- [ ] README documents setup, audit, fix commands with flags
- [ ] README explains hook workflow (setup -> audit -> fix)
- [ ] README has Troubleshooting with platform-specific notes
</success_criteria>

<output>
After completion, create `.planning/phases/17-distribution-documentation/17-01-SUMMARY.md`
</output>
