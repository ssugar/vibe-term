---
phase: 08-hud-strip-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/hooks/useTerminalWidth.ts
  - src/components/Tab.tsx
autonomous: true

must_haves:
  truths:
    - "Terminal width is tracked and updates on resize"
    - "Tab renders session data in compact format [index:name status context%]"
    - "Selected tabs have inverted colors"
    - "Blocked tabs have red background with bold text"
  artifacts:
    - path: "src/hooks/useTerminalWidth.ts"
      provides: "Terminal width hook with resize listener"
      exports: ["useTerminalWidth"]
    - path: "src/components/Tab.tsx"
      provides: "Single tab component for session display"
      exports: ["Tab"]
  key_links:
    - from: "src/hooks/useTerminalWidth.ts"
      to: "process.stdout"
      via: "columns property and resize event"
      pattern: "process\\.stdout\\.columns"
    - from: "src/components/Tab.tsx"
      to: "src/stores/types.ts"
      via: "Session type import"
      pattern: "import.*Session.*from"
---

<objective>
Create the foundation components for the HUD strip: a terminal width hook that tracks resize events, and a Tab component that renders session data in compact horizontal format.

Purpose: These building blocks are required before the TabStrip can calculate layout and render tabs.
Output: Two new files providing reusable terminal width tracking and individual tab rendering.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-hud-strip-ui/08-CONTEXT.md
@.planning/phases/08-hud-strip-ui/08-RESEARCH.md

@src/stores/types.ts
@src/components/SessionRow.tsx
@src/components/ContextMeter.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useTerminalWidth hook</name>
  <files>src/hooks/useTerminalWidth.ts</files>
  <action>
Create a React hook that provides terminal width and reacts to resize events.

Implementation:
1. Initialize state with `process.stdout.columns || 80` (fallback to 80 if undefined)
2. Set up resize listener on mount via `process.stdout.on('resize', handler)`
3. Handler updates state with new `process.stdout.columns` value
4. Clean up listener on unmount via `process.stdout.off('resize', handler)`
5. Return the current width as a number

Follow established hook patterns from `src/hooks/useInterval.ts` for structure.
Use ESM imports with .js extension per project conventions.

Example signature:
```typescript
export function useTerminalWidth(): number
```
  </action>
  <verify>
File exists at src/hooks/useTerminalWidth.ts
TypeScript compiles without errors: `npm run build`
  </verify>
  <done>
Hook exports useTerminalWidth function that returns terminal column width and updates on resize.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Tab component</name>
  <files>src/components/Tab.tsx</files>
  <action>
Create a Tab component that renders a single session as a compact horizontal tab.

Tab format (from CONTEXT.md): `[index:name status context%]`

Implementation:
1. Props interface:
   - session: Session
   - index: number (1-based display index)
   - isSelected: boolean
   - maxNameWidth: number (default 20)

2. Project name extraction:
   - Extract last directory from projectPath: `session.projectPath.split('/').pop()`
   - Truncate to maxNameWidth chars with ellipsis if needed

3. Status emoji (reuse from SessionRow.tsx):
   - idle: '\u2705' (checkmark)
   - working: '\u23F3' (hourglass)
   - tool: '\u{1F527}' (wrench)
   - blocked: '\u{1F6D1}' (stop sign)
   - ended: '\u274C' (X mark)

4. Context percentage:
   - Format as `${Math.round(contextUsage)}%`
   - Pad to 4 chars for consistent width: `.padStart(4)`
   - Color: green (<30%), yellow (30-70%), red (>70%)

5. Visual states (from CONTEXT.md):
   - Blocked: backgroundColor="red", color="white", bold
   - Selected (non-blocked): inverse={true}
   - Normal: default colors

6. Render format: `[{index}:{truncatedName} {emoji} {contextPct}]`
   - Include brackets as literal characters
   - Double space between tabs handled by parent TabStrip

Use Ink's Text component. Reference SessionRow.tsx for emoji mapping and color logic.
  </action>
  <verify>
File exists at src/components/Tab.tsx
TypeScript compiles without errors: `npm run build`
Component exports Tab function
  </verify>
  <done>
Tab component renders session in format [index:name status context%] with correct visual states for blocked, selected, and normal tabs.
  </done>
</task>

</tasks>

<verification>
```bash
# Build succeeds
npm run build

# New files exist
ls src/hooks/useTerminalWidth.ts
ls src/components/Tab.tsx

# Exports are correct
grep -q "export function useTerminalWidth" src/hooks/useTerminalWidth.ts
grep -q "export function Tab" src/components/Tab.tsx
```
</verification>

<success_criteria>
- useTerminalWidth hook created and exports correctly
- Tab component created with all visual states (blocked/selected/normal)
- Tab format matches spec: [index:name status context%]
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-hud-strip-ui/08-01-SUMMARY.md`
</output>
